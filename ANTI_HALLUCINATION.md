# Anti-Hallucination System

## –ü—Ä–æ–±–ª–µ–º–∞

AI-–∞–≥–µ–Ω—Ç—ã –∏–Ω–æ–≥–¥–∞ "–≥–∞–ª–ª—é—Ü–∏–Ω–∏—Ä—É—é—Ç" - –≤—ã–¥—É–º—ã–≤–∞—é—Ç –¥–∞–Ω–Ω—ã–µ –≤–º–µ—Å—Ç–æ —Ç–æ–≥–æ, —á—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã. –≠—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–æ –æ–ø–∞—Å–Ω–æ –¥–ª—è:

- –°–∏—Å—Ç–µ–º–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ (neofetch, disk usage, memory, CPU)
- –°–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Ñ–∞–π–ª–æ–≤
- –†–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∫–æ–º–∞–Ω–¥
- –°—Ç–∞—Ç—É—Å–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

## –†–µ—à–µ–Ω–∏–µ

–î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –¥–µ—Ç–µ–∫—Ü–∏–∏ –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–π –≤ `auryx_agent/core/agent.py`:

### 1. –°—Ç—Ä–æ–≥–∏–µ –ø—Ä–∞–≤–∏–ª–∞ –≤ System Prompt

```
üö® CRITICAL RULE - NO HALLUCINATIONS:
- NEVER invent or fabricate data, system information, or command outputs
- ALWAYS use tools to get real data from the system
- If user asks for system info (neofetch, disk usage, processes, etc.) - USE THE TOOL
- If you don't have a tool for something - SAY SO, don't make up data
```

### 2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –¥–µ—Ç–µ–∫—Ü–∏—è –≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–π

–ú–µ—Ç–æ–¥ `_detect_hallucination_risk()` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:

**–¢—Ä–∏–≥–≥–µ—Ä—ã (–∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç –æ):**
- neofetch, system info, disk usage/space
- memory, cpu, processes, running
- network, connections, files, directory
- –°–∏—Å—Ç–µ–º–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã: ls, ps, top, df, free, ifconfig, netstat, etc.

**–ü—Ä–∏–∑–Ω–∞–∫–∏ –≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–∏ (–µ—Å–ª–∏ –æ—Ç–≤–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç):**
- –†–∞–∑–º–µ—Ä—ã: GB, MB, KB, TB
- –°–∏—Å—Ç–µ–º–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏: CPU:, Memory:, Kernel:, OS:
- –ü—É—Ç–∏: /dev/, /home/
- –ü—Ä–æ—Ü–µ—Å—Å—ã: PID + USER –≤–º–µ—Å—Ç–µ

### 3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

–ï—Å–ª–∏ –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∞ –≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏—è:
1. –û—Ç–≤–µ—Ç –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è
2. –ê–≥–µ–Ω—Ç—É –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
3. –ê–≥–µ–Ω—Ç –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç

```python
if self._detect_hallucination_risk(user_input, response):
    warning = "\n\n‚ö†Ô∏è WARNING: You provided specific system data without using tools..."
    conversation += f"Assistant (REJECTED): {response}\n{warning}\n\n"
    user_input = f"You must use a tool to answer this question. Do not fabricate data."
    continue  # –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ —Å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–æ–∑–¥–∞–Ω –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤ –≤ `tests/test_hallucination_prevention.py`:

```bash
poetry run pytest tests/test_hallucination_prevention.py -v
```

**–¢–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç:**
- ‚úÖ –î–µ—Ç–µ–∫—Ü–∏—é —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π
- ‚úÖ –î–µ—Ç–µ–∫—Ü–∏—é —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ü–æ–∫—Ä—ã—Ç–∏–µ –≤—Å–µ—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∫–æ–º–∞–Ω–¥

## –ü—Ä–∏–º–µ—Ä—ã

### ‚ùå –†–∞–Ω—å—à–µ (–≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏—è):
```
User: —Å–∫–∏–Ω—å –≤—ã–≤–æ–¥ –∏–∑ neofetch
Agent: –í–æ—Ç –≤—ã–≤–æ–¥ –∏–∑ neofetch:
OS: Arch Linux x86_64
CPU: Intel Core i7-10700K @ 3.70GHz
Memory: 31.98GB
```
*–î–∞–Ω–Ω—ã–µ –≤—ã–¥—É–º–∞–Ω—ã!*

### ‚úÖ –¢–µ–ø–µ—Ä—å (—Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ):
```
User: —Å–∫–∏–Ω—å –≤—ã–≤–æ–¥ –∏–∑ neofetch
Agent: {"tool": "execute_command", "args": {"command": "neofetch"}}
[–†–µ–∞–ª—å–Ω—ã–π –≤—ã–≤–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã]
```

## –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ

–ß—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã, –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π —Å–ø–∏—Å–æ–∫ –≤ `_detect_hallucination_risk()`:

```python
system_info_keywords = [
    'neofetch', 'system info', 'disk usage', 'disk space',
    'your_new_keyword',  # –î–æ–±–∞–≤—å —Å—é–¥–∞
    ...
]
```

–ß—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–∞–Ω–Ω—ã—Ö:

```python
has_specific_data = any([
    'GB' in response or 'MB' in response,
    'your_pattern' in response,  # –î–æ–±–∞–≤—å —Å—é–¥–∞
    ...
])
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç

–ê–≥–µ–Ω—Ç —Ç–µ–ø–µ—Ä—å **–≤—Å–µ–≥–¥–∞** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏ **–Ω–∏–∫–æ–≥–¥–∞** –Ω–µ –≤—ã–¥—É–º—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ.
